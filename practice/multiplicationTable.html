
<link rel="stylesheet" href="../style.css" />



<h1>Multiplication Table Practice</h1><br>

<div id="problems"></div>

<main>

<button id="button">Begin!</button>

<div id = "time">Last problem:   Average: </div>

<div id="math" hidden></div>

<div id="result" hidden></div>

<p id="message" hidden aria-hidden="true">

  Your browser doesn't support Speech Recognition. We recommend Chrome for Desktop or Android

</p>

</main>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

<script id="MathJax-script"

        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">

</script>


      <input type="text">

        <script src="../isNumber.js" type="text/javascript"></script> 

        <script src="../resultToMath.js" type="text/javascript"></script> 


<script>


    function multiplication () {

        // copy paste some stuff in here to make function so less repetition of code

    }



    window.addEventListener("DOMContentLoaded", () => {

      const button = document.getElementById("button");

      const math = document.getElementById("math");

      const problems = document.getElementById("problems");

      const main = document.getElementsByTagName("main")[0];

      let listening = false;

      const SpeechRecognition =

        window.SpeechRecognition || window.webkitSpeechRecognition;

      if (typeof SpeechRecognition !== "undefined") {

        const recognition = new SpeechRecognition();
        startTime = Date.now();

        const stop = () => {

          main.classList.remove("speaking");

          recognition.stop();

          button.textContent = "Start listening";

        };

        // Index for tracking what problem they are on

        curIndex = 0;

        //create array for numbers

        arr = [

            "1 \\times 1 = ",

            "1 \\times 2 = ",

            "1 \\times 3 = ",

            "1 \\times 4 = ",

            "1 \\times 5 = ",

            "1 \\times 6 = ",

            "1 \\times 7 = ",

            "1 \\times 8 = ",

            "1 \\times 9 = ",

            "1 \\times 10 = ",

            "1 \\times 11 = ",

            "1 \\times 12 = ",

            "2 \\times 1 = ",

            "2 \\times 2 = ",

            "2 \\times 3 = ",

            "2 \\times 4 = ",

            "2 \\times 5 = ",

            "2 \\times 6 = ",

            "2 \\times 7 = ",

            "2 \\times 8 = ",

            "2 \\times 9 = ",

            "2 \\times 10 = ",

            "2 \\times 11 = ",

            "2 \\times 12 = ",

            "3 \\times 1 = ",

            "3 \\times 2 = ",

            "3 \\times 3 = ",

            "3 \\times 4 = ",

            "3 \\times 5 = ",

            "3 \\times 6 = ",

            "3 \\times 7 = ",

            "3 \\times 8 = ",

            "3 \\times 9 = ",

            "3 \\times 10 = ",

            "3 \\times 11 = ",

            "3 \\times 12 = ",

            "4 \\times 1 = ",

            "4 \\times 2 = ",

            "4 \\times 3 = ",

            "4 \\times 4 = ",

            "4 \\times 5 = ",

            "4 \\times 6 = ",

            "4 \\times 7 = ",

            "4 \\times 8 = ",

            "4 \\times 9 = ",

            "4 \\times 10 = ",

            "4 \\times 11 = ",

            "4 \\times 12 = ",

            "5 \\times 1 = ",

            "5 \\times 2 = ",

            "5 \\times 3 = ",

            "5 \\times 4 = ",

            "5 \\times 5 = ",

            "5 \\times 6 = ",

            "5 \\times 7 = ",

            "5 \\times 8 = ",

            "5 \\times 9 = ",

            "5 \\times 10 = ",

            "5 \\times 11 = ",

            "5 \\times 12 = ",

            "6 \\times 1 = ",

            "6 \\times 2 = ",

            "6 \\times 3 = ",

            "6 \\times 4 = ",

            "6 \\times 5 = ",

            "6 \\times 6 = ",

            "6 \\times 7 = ",

            "6 \\times 8 = ",

            "6 \\times 9 = ",

            "6 \\times 10 = ",

            "6 \\times 11 = ",

            "6 \\times 12 = ",

            "7 \\times 1 = ",

            "7 \\times 2 = ",

            "7 \\times 3 = ",

            "7 \\times 4 = ",

            "7 \\times 5 = ",

            "7 \\times 6 = ",

            "7 \\times 7 = ",

            "7 \\times 8 = ",

            "7 \\times 9 = ",

            "7 \\times 10 = ",

            "7 \\times 11 = ",

            "7 \\times 12 = ",

            "8 \\times 1 = ",

            "8 \\times 2 = ",

            "8 \\times 3 = ",

            "8 \\times 4 = ",

            "8 \\times 5 = ",

            "8 \\times 6 = ",

            "8 \\times 7 = ",

            "8 \\times 8 = ",

            "8 \\times 9 = ",

            "8 \\times 10 = ",

            "8 \\times 11 = ",

            "8 \\times 12 = ",

            "9 \\times 1 = ",

            "9 \\times 2 = ",

            "9 \\times 3 = ",

            "9 \\times 4 = ",

            "9 \\times 5 = ",

            "9 \\times 6 = ",

            "9 \\times 7 = ",

            "9 \\times 8 = ",

            "9 \\times 9 = ",

            "9 \\times 10 = ",

            "9 \\times 11 = ",

            "9 \\times 12 = ",

            "10 \\times 1 = ",

            "10 \\times 2 = ",

            "10 \\times 3 = ",

            "10 \\times 4 = ",

            "10 \\times 5 = ",

            "10 \\times 6 = ",

            "10 \\times 7 = ",

            "10 \\times 8 = ",

            "10 \\times 9 = ",

            "10 \\times 10 = ",

            "10 \\times 11 = ",

            "10 \\times 12 = ",

            "11 \\times 1 = ",

            "11 \\times 2 = ",

            "11 \\times 3 = ",

            "11 \\times 4 = ",

            "11 \\times 5 = ",

            "11 \\times 6 = ",

            "11 \\times 7 = ",

            "11 \\times 8 = ",

            "11 \\times 9 = ",

            "11 \\times 10 = ",

            "11 \\times 11 = ",

            "11 \\times 12 = ",

            "12 \\times 1 = ",

            "12 \\times 2 = ",

            "12 \\times 3 = ",

            "12 \\times 4 = ",

            "12 \\times 5 = ",

            "12 \\times 6 = ",

            "12 \\times 7 = ",

            "12 \\times 8 = ",

            "12 \\times 9 = ",

            "12 \\times 10 = ",

            "12 \\times 11 = ",

            "12 \\times 12 = "

        ];

        // randomize order

        function shuffle(array) {

            array.sort(() => Math.random() - 0.5);

        }

        shuffle(arr);

        answerArr = [];

        // evaluate array

        for(i = 0; i < 144; i ++){

          // grab and isolate the numbers out of it

          str1 = arr[i].substring (0, 2);

          str2 = arr[i].substring (arr [i].length - 5, arr [i].length - 3);

          // turn string numbers into numbers and calculate, populating new array

          str1 = str1.trim();

          str2 = str2.trim();

          answerArr.push(parseInt(str1, 10) * parseInt(str2, 10));

        }



        const start = () => {
          // starts clock so that timing can occur
          startTime = Date.now();
          main.classList.add("speaking");

          recognition.start();

          button.textContent = "Stop";

          // put onto page

          /* If you wanted to do a table

          problem_str = "<table><tr>"


          for (i = 1; i < 145; i ++){

            problem_str += "<td>\\(" + arr[i-1] + "\\)</td>";

            if (i % 12 == 0){

                problem_str += "</tr><tr>"

            }

          }

          problem_str += "</tr></table>";

          */

          document.getElementById("problems").innerHTML = "\\[" + arr[curIndex] + "\\]";

          MathJax.typeset()

        };


        timeSum = 0;
        answerString = "";
        stringNo = 0;
        const onResult = event => {

          math.innerHTML = "";

          result.innerHTML = "";

          for (const res of event.results) {

            const text = document.createTextNode(res[0].transcript);

            const p = document.createElement("p");

            if (res.isFinal) {

              p.classList.add("final");

            }

            p.appendChild(text);

            result.appendChild(p);

            

          }

          resultToMath (document.getElementById("result").textContent, "math");

          document.getElementById("problems").innerHTML = "\\[" + arr[curIndex] + "\\]";


          answerString = document.getElementById("result").innerHTML.substring(stringNo);
          console.log(answerString);
          // If the answer is correct, the next problem is put up there
          if (answerString.includes(answerArr[curIndex].toString())){
            // erase irrelevant parts of answer results
            stringNo += answerString.length;
            console.log(stringNo);
            curIndex ++;
            // log time taken to solve problem
            timeTaken = (Date.now() - startTime)/1000;
            timeSum = timeSum + timeTaken;
            document.getElementById("time").innerHTML = "Last problem: " + timeTaken.toString() + "s,  Average: " + Math.round((timeSum/curIndex) * 1000) / 1000 + "s";
            // resets time to be new, time results could also be fed to an array and then on the press of a button the array is submitted so that the data appears, php
            startTime = Date.now();
          }


          // resets so that math is in latex, does slow the program down a bit though

          MathJax.typeset()

        };

        recognition.continuous = true;

        recognition.interimResults = true;

        recognition.addEventListener("math", onResult);
        recognition.addEventListener("result", onResult);
        button.addEventListener("click", event => {

          listening ? stop() : start();

          listening = !listening;

        });

      } else {

        button.remove();

        const message = document.getElementById("message");

        message.removeAttribute("hidden");

        message.setAttribute("aria-hidden", "false");

                                var text = document.querySelector("input");

                        text.addEventListener("input", function() {

                                // turns contents to math

                               resultToMath(text.value, "math");

                        });


      }

    });

  </script>